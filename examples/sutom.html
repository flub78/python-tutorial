<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sutom - Aide √† la r√©solution</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px;
        }

        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 20px;
            }
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        /* Onglets */
        .tabs {
            display: flex;
            border-bottom: 2px solid #4CAF50;
            margin-bottom: 20px;
            gap: 5px;
        }

        .tab {
            padding: 10px 20px;
            background-color: #e0e0e0;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 8px 8px 0 0;
            transition: background-color 0.3s;
        }

        .tab:hover {
            background-color: #d0d0d0;
        }

        .tab.active {
            background-color: #4CAF50;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .tab {
                padding: 8px 12px;
                font-size: 14px;
            }
        }

        .config-section {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fafafa;
        }

        .config-section h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #555;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: inline-block;
            width: 150px;
            font-weight: bold;
        }

        .form-group input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .form-group {
                margin-bottom: 10px;
            }
            
            .form-group label {
                display: block;
                width: 100%;
                margin-bottom: 5px;
            }
            
            .form-group input[type="file"] {
                width: 100%;
                font-size: 12px;
            }
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: auto;
        }

        button:hover {
            background-color: #45a049;
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            button {
                font-size: 14px;
                padding: 8px 16px;
                width: 100%;
            }
        }

        .proposition-section {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fafafa;
        }

        .proposition-section h2 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #555;
        }

        .info-text {
            margin-bottom: 15px;
            color: #666;
            font-size: 14px;
        }

        .lettres-container {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .lettre-btn {
            width: 60px;
            height: 60px;
            font-size: 32px;
            font-weight: bold;
            background-color: #e0e0e0;
            border: 3px solid #999;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            color: #333;
        }

        @media (max-width: 768px) {
            .lettres-container {
                gap: 3px;
                margin: 10px 0;
            }
            
            .lettre-btn {
                width: 45px;
                height: 45px;
                font-size: 24px;
                border: 2px solid #999;
            }
        }

        @media (max-width: 480px) {
            .lettre-btn {
                width: 38px;
                height: 38px;
                font-size: 20px;
            }
        }

        .lettre-btn:hover {
            transform: scale(1.05);
        }

        .lettre-btn.bien-placee {
            background-color: #D32F2F;
            color: white;
            border-color: #B71C1C;
        }

        .lettre-btn.mal-placee {
            background-color: #C9B458;
            color: white;
            border-color: #B8A040;
        }

        .lettre-btn.absente {
            background-color: #5B8FDB;
            color: white;
            border-color: #4A7FCA;
        }

        .legende-section {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #fafafa;
        }

        .legende-section h2 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #555;
        }

        .legende-container {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .legende-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legende-box {
            width: 30px;
            height: 30px;
            border: 2px solid #666;
            border-radius: 4px;
        }

        .legende-help {
            margin-top: 10px;
            font-size: 12px;
            color: #888;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .legende-container {
                gap: 10px;
            }
            
            .legende-item {
                font-size: 14px;
            }
            
            .legende-box {
                width: 25px;
                height: 25px;
            }
            
            .legende-help {
                font-size: 11px;
            }
        }

        .historique-section {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            background-color: #fafafa;
        }

        .historique-section h2 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #555;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            font-size: 14px;
        }

        th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .lettre-historique {
            display: inline-block;
            padding: 2px 6px;
            margin: 0 1px;
            border-radius: 3px;
            font-weight: bold;
        }

        .lettre-historique.bien-placee {
            background-color: #D32F2F;
            color: white;
        }

        .lettre-historique.mal-placee {
            background-color: #C9B458;
            color: white;
        }

        .lettre-historique.absente {
            background-color: #5B8FDB;
            color: white;
        }

        @media (max-width: 768px) {
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 4px;
            }
            
            th:nth-child(3), td:nth-child(3) {
                display: none;
            }
            
            .lettre-historique {
                padding: 1px 4px;
                margin: 0;
                font-size: 11px;
            }
        }

        @media (max-width: 480px) {
            table {
                font-size: 11px;
            }
            
            th, td {
                padding: 6px 2px;
            }
        }

        .context-menu {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            padding: 5px 0;
            z-index: 1000;
            min-width: 180px;
        }

        .context-menu-item {
            padding: 10px 20px;
            cursor: pointer;
        }

        .context-menu-item:hover {
            background-color: #f0f0f0;
        }

        .hidden {
            display: none;
        }

        .message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .message.error {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ef5350;
        }

        .message.success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #66bb6a;
        }

        .message.info {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 1px solid #42a5f5;
        }

        /* Styles pour le mode jeu */
        .input-mot {
            padding: 10px;
            font-size: 18px;
            text-transform: uppercase;
            border: 2px solid #ccc;
            border-radius: 4px;
            width: 100%;
            max-width: 300px;
            text-align: center;
        }

        .tentatives-jeu {
            margin-top: 20px;
        }

        .tentative-row {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 10px 0;
        }

        .lettre-jeu {
            width: 50px;
            height: 50px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border-radius: 6px;
            border: 2px solid #999;
        }

        @media (max-width: 768px) {
            .lettre-jeu {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sutom pour les marcheurs fatigu√©s</h1>

        <!-- Section commune de chargement du dictionnaire -->
        <div class="config-section" id="fichierDicoSection">
            <h2>Dictionnaire</h2>
            <div class="form-group" id="fichierDicoGroup">
                <label for="fichierDico">Fichier dictionnaire:</label>
                <input type="file" id="fichierDico" accept=".txt" onchange="chargerFichierDictionnaire()">
                <span style="margin-left: 10px; color: #666; font-size: 12px;" id="dicoStatus">Chargement du dictionnaire...</span>
            </div>
        </div>

        <!-- Onglets -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('aide')">Aide √† la r√©solution</button>
            <button class="tab" onclick="switchTab('jeu')">Jouer</button>
        </div>

        <!-- Onglet Aide -->
        <div id="aide-tab" class="tab-content active">
        <!-- Section Configuration -->
        <div class="config-section">
            <h2>Configuration</h2>
            <div class="form-group">
                <label for="premiereLettre">Premi√®re lettre:</label>
                <input type="text" id="premiereLettre" maxlength="1" style="width: 50px; text-transform: uppercase;">
            </div>
            <div class="form-group">
                <label for="nombreLettres">Nombre de lettres:</label>
                <input type="number" id="nombreLettres" min="3" max="15" value="6" style="width: 80px;">
            </div>
            <div class="form-group">
                <button onclick="demarrer()">D√©marrer</button>
            </div>
            <div id="configMessage"></div>
        </div>

        <!-- Section Proposition -->
        <div class="proposition-section hidden" id="propositionSection">
            <h2>Proposition actuelle</h2>
            <div class="info-text" id="infoText"></div>
            <div class="lettres-container" id="lettresContainer"></div>
            <div style="text-align: center;">
                <button onclick="validerReponse()" id="validerBtn">Valider et continuer</button>
            </div>
        </div>

        <!-- Section L√©gende -->
        <div class="legende-section">
            <h2>L√©gende</h2>
            <div class="legende-container">
                <div class="legende-item">
                    <div class="legende-box" style="background-color: #D32F2F;"></div>
                    <span>Bien plac√©e (=)</span>
                </div>
                <div class="legende-item">
                    <div class="legende-box" style="background-color: #C9B458;"></div>
                    <span>Mal plac√©e (?)</span>
                </div>
                <div class="legende-item">
                    <div class="legende-box" style="background-color: #5B8FDB;"></div>
                    <span>Absente (_)</span>
                </div>
            </div>
        </div>

        <!-- Section Historique -->
        <div class="historique-section">
            <h2>Historique des propositions</h2>
            <table>
                <thead>
                    <tr>
                        <th>Essai</th>
                        <th>Mot</th>
                        <th>Candidats restants</th>
                    </tr>
                </thead>
                <tbody id="historiqueBody">
                </tbody>
            </table>
        </div>
        </div>

        <!-- Onglet Jeu -->
        <div id="jeu-tab" class="tab-content">
            <div class="config-section">
                <h2>Configuration du jeu</h2>
                <div class="form-group">
                    <label for="nombreLettresJeu">Nombre de lettres:</label>
                    <input type="number" id="nombreLettresJeu" min="3" max="15" value="6" style="width: 80px;">
                </div>
                <div class="form-group">
                    <button onclick="demarrerJeu()">Nouvelle partie</button>
                </div>
                <div id="jeuMessage"></div>
            </div>

            <div class="proposition-section hidden" id="jeuSection">
                <h2>Tentez de deviner le mot</h2>
                <div class="info-text" id="jeuInfo"></div>
                
                <div style="text-align: center; margin: 20px 0;">
                    <input type="text" 
                           id="inputMotJeu" 
                           class="input-mot" 
                           placeholder="Entrez votre mot"
                           onkeypress="if(event.key==='Enter') soumettreMotJeu()">
                    <br><br>
                    <button onclick="soumettreMotJeu()">Valider</button>
                </div>

                <div class="tentatives-jeu" id="tentativesJeu"></div>
            </div>

            <div class="legende-section">
                <h2>L√©gende</h2>
                <div class="legende-container">
                    <div class="legende-item">
                        <div class="legende-box" style="background-color: #D32F2F;"></div>
                        <span>Bien plac√©e</span>
                    </div>
                    <div class="legende-item">
                        <div class="legende-box" style="background-color: #C9B458;"></div>
                        <span>Mal plac√©e</span>
                    </div>
                    <div class="legende-item">
                        <div class="legende-box" style="background-color: #5B8FDB;"></div>
                        <span>Absente</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu contextuel -->
    <div id="contextMenu" class="context-menu hidden">
        <div class="context-menu-item" onclick="setEtat(currentLettreIndex, '=')">‚úì Bien plac√©e (=)</div>
        <div class="context-menu-item" onclick="setEtat(currentLettreIndex, '?')">? Mal plac√©e (?)</div>
        <div class="context-menu-item" onclick="setEtat(currentLettreIndex, '_')">‚úó Absente (_)</div>
    </div>

    <script>
        // Variables globales pour l'aide
        let dictionnaire = [];
        let candidats = [];
        let essai = 0;
        let motActuel = '';
        let reponseActuelle = [];
        let currentLettreIndex = -1;
        let lettresConnues = {}; // Pour m√©moriser les lettres bien plac√©es

        // Variables globales pour le jeu
        let motSecret = '';
        let tentativesJeu = 0;
        let maxTentatives = 6;
        let partieTerminee = false;

        // Gestion des onglets
        function switchTab(tabName) {
            // Masquer tous les contenus
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // D√©sactiver tous les onglets
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activer l'onglet s√©lectionn√©
            if (tabName === 'aide') {
                document.getElementById('aide-tab').classList.add('active');
                document.querySelectorAll('.tab')[0].classList.add('active');
            } else if (tabName === 'jeu') {
                document.getElementById('jeu-tab').classList.add('active');
                document.querySelectorAll('.tab')[1].classList.add('active');
            }
        }

        // Essayer de charger le dictionnaire par d√©faut au d√©marrage
        window.addEventListener('DOMContentLoaded', function() {
            fetch('dico.txt')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Fichier non trouv√©');
                    }
                    return response.text();
                })
                .then(data => {
                    dictionnaire = data.split('\n')
                        .map(mot => mot.trim().toUpperCase())
                        .filter(mot => mot.length > 0);
                    document.getElementById('dicoStatus').textContent = `‚úì Dictionnaire charg√©: ${dictionnaire.length} mots`;
                    document.getElementById('dicoStatus').style.color = '#2e7d32';
                    // Cacher la section de chargement si le dictionnaire par d√©faut est charg√©
                    document.getElementById('fichierDicoSection').style.display = 'none';
                    console.log(`Dictionnaire par d√©faut charg√©: ${dictionnaire.length} mots`);
                })
                .catch(error => {
                    document.getElementById('dicoStatus').textContent = 'Veuillez charger un fichier dictionnaire';
                    document.getElementById('dicoStatus').style.color = '#c62828';
                    console.log('Pas de dictionnaire par d√©faut, utilisateur devra en charger un');
                });
        });

        // Charger le fichier dictionnaire s√©lectionn√©
        function chargerFichierDictionnaire() {
            const fileInput = document.getElementById('fichierDico');
            const file = fileInput.files[0];
            
            if (!file) {
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                dictionnaire = content.split('\n')
                    .map(mot => mot.trim().toUpperCase())
                    .filter(mot => mot.length > 0);
                document.getElementById('dicoStatus').textContent = `‚úì Dictionnaire charg√©: ${dictionnaire.length} mots`;
                document.getElementById('dicoStatus').style.color = '#2e7d32';
                console.log(`Dictionnaire charg√©: ${dictionnaire.length} mots`);
            };
            reader.onerror = function() {
                document.getElementById('dicoStatus').textContent = 'Erreur lors de la lecture du fichier';
                document.getElementById('dicoStatus').style.color = '#c62828';
            };
            reader.readAsText(file, 'UTF-8');
        }

        // Charger dictionnaire selon crit√®res
        function chargerDictionnaire(premiereLettre, longueur) {
            return dictionnaire.filter(mot => 
                mot.length === longueur && mot[0] === premiereLettre
            );
        }

        // G√©n√©rer le pattern de r√©ponse
        function genererPattern(motTest, motSolution) {
            let pattern = Array(motTest.length).fill('_');
            let lettresSolution = motSolution.split('');

            // D'abord les bien plac√©es
            for (let i = 0; i < motTest.length; i++) {
                if (motTest[i] === motSolution[i]) {
                    pattern[i] = '=';
                    lettresSolution[i] = null;
                }
            }

            // Puis les mal plac√©es
            for (let i = 0; i < motTest.length; i++) {
                if (pattern[i] === '_' && lettresSolution.includes(motTest[i])) {
                    pattern[i] = '?';
                    lettresSolution[lettresSolution.indexOf(motTest[i])] = null;
                }
            }

            return pattern.join('');
        }

        // Calculer l'entropie
        function calculerEntropie(motTest, candidats) {
            let partitions = {};
            
            candidats.forEach(candidat => {
                let pattern = genererPattern(motTest, candidat);
                if (!partitions[pattern]) {
                    partitions[pattern] = [];
                }
                partitions[pattern].push(candidat);
            });

            let entropie = 0;
            let n = candidats.length;

            Object.values(partitions).forEach(groupe => {
                let p = groupe.length / n;
                if (p > 0) {
                    entropie -= p * Math.log2(p);
                }
            });

            return entropie;
        }

        // Trouver le meilleur mot
        function meilleurMot(candidats) {
            if (candidats.length === 1) {
                return candidats[0];
            }

            let meilleur = null;
            let maxEntropie = -1;

            candidats.forEach(mot => {
                let entropie = calculerEntropie(mot, candidats);
                if (entropie > maxEntropie) {
                    maxEntropie = entropie;
                    meilleur = mot;
                }
            });

            return meilleur;
        }

        // Filtrer les candidats
        function filtrerCandidats(candidats, motTest, reponse) {
            return candidats.filter(candidat => 
                genererPattern(motTest, candidat) === reponse
            );
        }

        // D√©marrer une nouvelle partie
        function demarrer() {
            if (dictionnaire.length === 0) {
                showMessage('configMessage', 'Veuillez d\'abord charger un fichier dictionnaire ou attendre le chargement du dictionnaire par d√©faut', 'error');
                return;
            }

            let premiereLettre = document.getElementById('premiereLettre').value.trim().toUpperCase();
            let nombreLettres = parseInt(document.getElementById('nombreLettres').value);

            if (!premiereLettre || premiereLettre.length !== 1) {
                showMessage('configMessage', 'Veuillez entrer une seule lettre', 'error');
                return;
            }

            if (!nombreLettres || nombreLettres < 3 || nombreLettres > 15) {
                showMessage('configMessage', 'Veuillez entrer un nombre de lettres valide (3-15)', 'error');
                return;
            }

            candidats = chargerDictionnaire(premiereLettre, nombreLettres);

            if (candidats.length === 0) {
                showMessage('configMessage', 'Aucun mot trouv√© avec ces crit√®res', 'error');
                return;
            }

            showMessage('configMessage', `${candidats.length} mots possibles trouv√©s`, 'success');

            // R√©initialiser
            essai = 0;
            lettresConnues = {}; // R√©initialiser les lettres connues
            document.getElementById('historiqueBody').innerHTML = '';
            document.getElementById('propositionSection').classList.remove('hidden');

            proposerMot();
        }

        // Proposer un nouveau mot
        function proposerMot() {
            if (candidats.length === 0) {
                showMessage('configMessage', 'Aucun mot ne correspond aux r√©ponses donn√©es', 'info');
                return;
            }

            essai++;
            motActuel = meilleurMot(candidats);
            reponseActuelle = Array(motActuel.length).fill('_');

            // Pr√©-remplir avec les lettres connues
            for (let pos in lettresConnues) {
                let index = parseInt(pos);
                if (motActuel[index] === lettresConnues[pos]) {
                    reponseActuelle[index] = '=';
                }
            }

            document.getElementById('infoText').textContent = 
                `Essai ${essai} - ${candidats.length} candidat(s) restant(s)`;

            // Afficher les lettres
            let container = document.getElementById('lettresContainer');
            container.innerHTML = '';

            for (let i = 0; i < motActuel.length; i++) {
                let btn = document.createElement('button');
                btn.className = 'lettre-btn';
                btn.textContent = motActuel[i];
                btn.onclick = () => cycleEtat(i);
                btn.oncontextmenu = (e) => {
                    e.preventDefault();
                    afficherMenu(e, i);
                };
                
                // Appliquer la couleur par d√©faut si lettre connue
                if (reponseActuelle[i] === '=') {
                    btn.classList.add('bien-placee');
                }
                
                container.appendChild(btn);
            }
        }

        // Changer l'√©tat d'une lettre (cycle)
        function cycleEtat(index) {
            let etats = ['_', '?', '='];
            let etatActuel = reponseActuelle[index];
            let nouvelEtat = etats[(etats.indexOf(etatActuel) + 1) % 3];
            setEtat(index, nouvelEtat);
        }

        // D√©finir l'√©tat d'une lettre
        function setEtat(index, etat) {
            reponseActuelle[index] = etat;
            
            let btn = document.getElementById('lettresContainer').children[index];
            btn.className = 'lettre-btn';
            
            if (etat === '=') {
                btn.classList.add('bien-placee');
            } else if (etat === '?') {
                btn.classList.add('mal-placee');
            } else if (etat === '_') {
                btn.classList.add('absente');
            }

            document.getElementById('contextMenu').classList.add('hidden');
        }

        // Afficher le menu contextuel
        function afficherMenu(event, index) {
            currentLettreIndex = index;
            let menu = document.getElementById('contextMenu');
            menu.style.left = event.pageX + 'px';
            menu.style.top = event.pageY + 'px';
            menu.classList.remove('hidden');
        }

        // Cacher le menu contextuel au clic ailleurs
        document.addEventListener('click', () => {
            document.getElementById('contextMenu').classList.add('hidden');
        });

        // Valider la r√©ponse
        function validerReponse() {
            let reponse = reponseActuelle.join('');

            // M√©moriser les lettres bien plac√©es
            for (let i = 0; i < motActuel.length; i++) {
                if (reponseActuelle[i] === '=') {
                    lettresConnues[i] = motActuel[i];
                }
            }

            // Cr√©er l'affichage du mot avec les couleurs
            let motColore = '';
            for (let i = 0; i < motActuel.length; i++) {
                let classe = '';
                if (reponseActuelle[i] === '=') {
                    classe = 'bien-placee';
                } else if (reponseActuelle[i] === '?') {
                    classe = 'mal-placee';
                } else {
                    classe = 'absente';
                }
                motColore += `<span class="lettre-historique ${classe}">${motActuel[i]}</span>`;
            }

            // Ajouter √† l'historique
            let tbody = document.getElementById('historiqueBody');
            let row = tbody.insertRow();
            row.insertCell(0).textContent = essai;
            row.insertCell(1).innerHTML = motColore;
            row.insertCell(2).textContent = candidats.length;

            // V√©rifier si gagn√©
            if (reponse === '='.repeat(motActuel.length)) {
                showMessage('configMessage', `üéâ Mot trouv√© en ${essai} essai(s): ${motActuel}`, 'success');
                document.getElementById('propositionSection').classList.add('hidden');
                return;
            }

            // Filtrer les candidats
            candidats = filtrerCandidats(candidats, motActuel, reponse);

            if (candidats.length === 0) {
                showMessage('configMessage', 'Aucun mot ne correspond. V√©rifiez vos r√©ponses.', 'error');
                document.getElementById('propositionSection').classList.add('hidden');
                return;
            }

            // Proposer le mot suivant
            proposerMot();
        }

        // Afficher un message
        function showMessage(elementId, message, type) {
            let element = document.getElementById(elementId);
            element.innerHTML = `<div class="message ${type}">${message}</div>`;
        }

        // ===== FONCTIONS POUR LE MODE JEU =====

        // D√©marrer une nouvelle partie
        function demarrerJeu() {
            if (dictionnaire.length === 0) {
                showMessage('jeuMessage', 'Veuillez d\'abord charger un dictionnaire ou attendre son chargement', 'error');
                return;
            }

            let longueur = parseInt(document.getElementById('nombreLettresJeu').value);
            if (!longueur || longueur < 3 || longueur > 15) {
                showMessage('jeuMessage', 'Veuillez entrer un nombre de lettres valide (3-15)', 'error');
                return;
            }

            // Filtrer les mots de la bonne longueur
            let motsDisponibles = dictionnaire.filter(mot => mot.length === longueur);
            
            if (motsDisponibles.length === 0) {
                showMessage('jeuMessage', 'Aucun mot de cette longueur dans le dictionnaire', 'error');
                return;
            }

            // Choisir un mot au hasard
            motSecret = motsDisponibles[Math.floor(Math.random() * motsDisponibles.length)];
            tentativesJeu = 0;
            partieTerminee = false;

            // R√©initialiser l'interface
            document.getElementById('tentativesJeu').innerHTML = '';
            document.getElementById('inputMotJeu').value = '';
            document.getElementById('inputMotJeu').maxLength = longueur;
            document.getElementById('jeuSection').classList.remove('hidden');
            
            updateJeuInfo();
            showMessage('jeuMessage', `Partie d√©marr√©e ! Trouvez le mot de ${longueur} lettres commen√ßant par ${motSecret[0]}`, 'success');
            
            console.log('Mot secret:', motSecret); // Pour debug
        }

        // Mettre √† jour les infos du jeu
        function updateJeuInfo() {
            document.getElementById('jeuInfo').textContent = 
                `Tentative ${tentativesJeu + 1}/${maxTentatives} - Mot de ${motSecret.length} lettres commen√ßant par ${motSecret[0]}`;
        }

        // Soumettre un mot
        function soumettreMotJeu() {
            if (partieTerminee) {
                return;
            }

            let motPropose = document.getElementById('inputMotJeu').value.trim().toUpperCase();
            
            // Validations
            if (motPropose.length !== motSecret.length) {
                showMessage('jeuMessage', `Le mot doit contenir exactement ${motSecret.length} lettres`, 'error');
                return;
            }

            if (motPropose[0] !== motSecret[0]) {
                showMessage('jeuMessage', `Le mot doit commencer par ${motSecret[0]}`, 'error');
                return;
            }

            if (!dictionnaire.includes(motPropose)) {
                showMessage('jeuMessage', 'Ce mot n\'est pas dans le dictionnaire', 'error');
                return;
            }

            // Traiter la tentative
            tentativesJeu++;
            afficherTentativeJeu(motPropose);
            
            // V√©rifier si gagn√©
            if (motPropose === motSecret) {
                partieTerminee = true;
                showMessage('jeuMessage', `üéâ Bravo ! Vous avez trouv√© le mot "${motSecret}" en ${tentativesJeu} tentative(s) !`, 'success');
                document.getElementById('inputMotJeu').disabled = true;
                return;
            }

            // V√©rifier si perdu
            if (tentativesJeu >= maxTentatives) {
                partieTerminee = true;
                showMessage('jeuMessage', `üòû Perdu ! Le mot √©tait "${motSecret}"`, 'error');
                document.getElementById('inputMotJeu').disabled = true;
                return;
            }

            // Continuer
            document.getElementById('inputMotJeu').value = '';
            updateJeuInfo();
            showMessage('jeuMessage', '', 'info');
        }

        // Afficher une tentative
        function afficherTentativeJeu(motPropose) {
            let pattern = genererPattern(motPropose, motSecret);
            
            let tentativeDiv = document.createElement('div');
            tentativeDiv.className = 'tentative-row';
            
            for (let i = 0; i < motPropose.length; i++) {
                let lettreDiv = document.createElement('div');
                lettreDiv.className = 'lettre-jeu';
                lettreDiv.textContent = motPropose[i];
                
                if (pattern[i] === '=') {
                    lettreDiv.style.backgroundColor = '#D32F2F';
                    lettreDiv.style.color = 'white';
                    lettreDiv.style.borderColor = '#B71C1C';
                } else if (pattern[i] === '?') {
                    lettreDiv.style.backgroundColor = '#C9B458';
                    lettreDiv.style.color = 'white';
                    lettreDiv.style.borderColor = '#B8A040';
                } else {
                    lettreDiv.style.backgroundColor = '#5B8FDB';
                    lettreDiv.style.color = 'white';
                    lettreDiv.style.borderColor = '#4A7FCA';
                }
                
                tentativeDiv.appendChild(lettreDiv);
            }
            
            document.getElementById('tentativesJeu').appendChild(tentativeDiv);
        }
    </script>
</body>
</html>
